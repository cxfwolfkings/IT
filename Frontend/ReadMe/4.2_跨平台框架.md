# 跨平台框架

## 技术选型

**React Native** (RN) 的开发者是 Facebook，Facebook 本身也在尝试使用 RN 技术开发自己的 App。

RN 使用 JS 更新虚拟 DOM，通过一个桥接器将需要更新的结果通知到 UI 层，让 Native 执行 UI 的改变。

![x](./Resource/RN渲染.png)

**Weex** 核心思想上，与 RN 其实并没有什么区别，Weex 也可以算是站在 RN 的肩膀上起步的，目前活跃度不高，大多数是在观望中。Weex 使用 Vue，熟悉 Vue 的开发者可能会更熟悉。

**Flutter**是谷歌的移动UI框架，可以快速在iOS和Android上构建高质量的原生用户界面。Flutter可以与现有的代码一起工作。在全世界，Flutter正在被越来越多的开发者和组织使用，并且Flutter是完全免费、开源的。

Flutter中文社区：[https://flutterchina.club/](https://flutterchina.club/)

技术|性能|开发效率|渲染方式|学习成本|可扩展性
-|-|-|-|-|-
Flutter|高，接近原生体验|高|Skia 高性能自绘引擎|低，Widget 组件化|高，采用插件化的库进行扩展
RN/Weex/小程序|有延迟，一般|一般，复杂、效率低|Js驱动原生渲染|高，复杂|一般
原生应用|高|一般|原生渲染|高，需要学习 Android 和 iOS 原生 API|高

Flutter 不使用系统提供的组件，自己实现了一套渲染机制，所以在性能优化、跨平台方面表现优秀。实际体验上，性能比 RN 要高不少。

![x](./Resource/Flutter渲染机制.png)

Flutter 内置了对 Material Design 的支持，给开发者提供了丰富的 UI 控件库选择，同时所有的组件都有扩展，保持了很高的灵活性。

RN 通过 React 也做到了组件式开发，跟 Flutter 相比，多了一个桥接器的转换，性能上肯定不如 Flutter。

Flutter 使用 Dart 实现，Dart 号称要完全取代 JS，不过目前离这个目标还非常远，初期上手还是有一些难度的。

RN 使用 JS 开发，做过前端的都非常熟悉，上手很容易。

**Electron**是一个基于 V8 引擎和 Node.js 的开发框架，允许用 JavaScript 开发跨平台（Windows、Mac OS X 和 Linux）桌面应用。

目前有相当多的桌面应用是使用 Electron 开发的，例如，著名的 Visual Studio Code（微软推出的一个跨平台源代码编辑器）就是用 Electron 开发的；还有蚂蚁小程序（在支付宝中运行的小程序）的开发工具也是用 Electron 来开发的；以小米、华为为主的众多手机厂商推出的快应用（类似于微信小程序）的 IDE 也是用 Electron 开发的。

从 Electron 的主要用户来看，很多都是大厂，如蚂蚁金服、小米、华为、GitHub（Electron 就是 GitHub 推出的）、微软等，由于现在 GitHub 被微软收购了，因而目前 Electron 的后台是微软。

Node.js 和 Electron 堪称 JavaScript 的左右护法，前者让 JavaScript 可以轻而易举地跨越不同类型应用的界限，后者让 JavaScript 可以进入服务端和桌面应用领域。有了这两个护法，JavaScript 可以真正成为唯一的全栈开发语言，从 Web 到移动，再到服务端，再到桌面应用，甚至是终端程序，无所不能。

## 目录

1. [Flutter](#Flutter)
   - [Flutter环境搭建](#Flutter环境搭建)
2. [React Native](#React&nbsp;Native)
3. [Electron](#Electron)

## Flutter

- [DartPad](https://dartpad.dartlang.org/)：网上练习Dart代码
- [官方下载地址](https://flutter.dev/docs/development/tools/sdk/releases#windows)

### Flutter环境搭建

**环境变量：**

- 变量名：PUB_HOSTED_URL，变量值：`https://pub.flutter-io.cn`
- 变量名：FLUTTER_STORAGE_BASE_URL，变量值：`https://storage.flutter-io.cn`
- 将 Flutter 的 bin 目录加入Path环境变量
- 安装 android studio
- 在 android studio 编辑 -> 设置，搜索 Dart 和 Flutter 插件
- 检查：`flutter doctor`

**创建项目：**

- Ctrl+Shif+P 打开命令面板，找到 Flutter：New Project
- 自动生成项目目录结构

  >Android 相关的修改和配置在 android 目录下，结构和 Android 应用项目结构一样；iOS 相关修改和配置在 ios 目录下，结构和 iOS 应用项目结构一样。最重要的 flutter 代码文件是在 lib 目录下，类文件以 .dart 结尾，语法结构为 Dart 语法结构。

- 创建[bat文件](../../Codes/wind_eim/runAndroid.bat)，便于启动Android模拟器
- 运行项目：`flutter run`

**主要建议：**

- 使用稳定版或者开发版 Flutter SDK，推荐使用稳定版。
- 如果遇到下载 SDK 慢或者无法下载情况，请按照课程内设置国内下载镜像地址。
- 配置好环境变量后，用 `flutter doctor` 检查环境。
- 尝试新建一个项目运行到手机或模拟器上，看配置是否有问题。
- 开发工具可以使用 Visual Studio Code 或 Android Studio 等。

## React&nbsp;Native

## Electron

- 安装：`cnpm install electron -g`
- 查看版本：`electron -v`
- 删除：`npm uninstall electron`
- 升级：`npm update electron -g`
- 运行应用：`electron .`

对于 Electron 应用来说，事件分为如下两类：

- 原生事件
- Web 事件

### 打开对话框

```js
dialog.showOpenDialog([browserWindow, ]options[, callback])
```

其中 browserWindow 和 callback 都是可选的，browserWindow 参数允许该对话框将自身附加到父窗口，作为父窗口的模态对话框。callback 是回调函数，用于返回打开文件或目录后的返回值（文件或目录的绝对路径），如果步指定 callback 参数，通过 showOpenDialog 方法返回打开的文件或目录的绝对路径。

options 是必选参数，该参数是一个对象，包含了一些用于设置打开对话框的属性，主要属性的功能及含义如下表所示。

属性|数据类型|功能|可选 / 必选
-|-|-|-
title|String|对话框标题|可选
defaultPath|String|默认路径|可选
buttonLabel|String|按钮文本，当为空时，使用默认按钮文本|可选
filters|Array|过滤器，用于过滤指定类型的文件|可选
properties|Array|包含对话框的功能，如打开文件、打开目录、多选等|必选
message|String|将标题显示在打开对话框顶端|可选
