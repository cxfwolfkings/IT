# 客户端javascript

## DOM

### frame

- iframe标签是成对出现的，以`<iframe>`开始，`</iframe>`结束
- iframe标签内的内容可以做为浏览器不支持iframe标签时显示

属性

Common -- 一般属性

- name -- 定义了内容页名称,此名称在框架页内链接时使用到
- src -- 定义了内容页URL(同frame标签)
- frameborder -- 定义了内容页的边框,取值为(1|0),缺省值为1
  - 1 -- 在每个页面之间都显示边框
  - 0 -- 不显示边框
- height -- 框架的高度,取值像素或百分比
- width -- 框架的宽度,取值像素或百分比
- marginwidth -- 定义了框架中HTML文件显示的左右边界的宽度,取值为px,缺省值由浏览器决定
- marginheight -- 定义了框架中HTML文件显示的上下边界的宽度,取值为px,缺省值由浏览器决定
- scrolling -- 定义是否有滚动条,取值为(yes|no|auto),缺省值为auto
  - yes -- 显示滚动条
  - no -- 不显示滚动条
  - auto -- 当需要时再显示滚动条
- align -- 垂直或水平对齐方式
- longdesc -- 定义框架页的说明

iframe的调用包括以下几个方面：（调用包含html dom，js全局变量，js方法）

- 主页面调用iframe；
- iframe页面调用主页面；
- 主页面包含的iframe之间相互调用；

主要知识点:

1. `document.getElementById("ii").contentWindow` 得到iframe对象后，就可以通过contentWindow得到iframe包含页面的window对象，然后就可以正常访问页面元素了；
2. `$("#ii")[0].contentWindow`  如果用jquery选择器获得iframe，需要加一个[0]；
3. `$("#ii")[0].contentWindow.$("#dd").val()` 可以在得到iframe的window对象后接着使用jquery选择器进行页面操作;
4. `$("#ii")[0].contentWindow.hellobaby="…";` 可以通过这种方式向iframe页面传递参数，在iframe页面window.hellobaby就可以获取到值，hellobaby是自定义的变量；
5. 在iframe页面通过parent可以获得主页面的window，接着就可以正常访问父亲页面的元素了；
6. `parent.$("#ii")[0].contentWindow.ff;` 同级iframe页面之间调用，需要先得到父亲的window，然后调用同级的iframe得到window进行操作；

一个页面中的所有框架以集合的形式作为window对象的属性提供，例如：window.frames就表示该页面内所有框架的集合，这和表单对象、链接对象、图片对象等是类似的，不同的是，这些集合是document的属性。因此，要引用一个子框架，可以使用如下语法：

```js
window.frames["frameName"];
window.frames.frameName
window.frames[index]
```

其中，window字样也可以用self代替或省略，假设frameName为页面中第一个框架，则以下的写法是等价的：

```js
self.frames["frameName"]
self.frames[0]
frames[0]
```

每个框架都对应一个HTML页面，所以这个框架也是一个独立的浏览器窗口，它具有窗口的所有性质，所谓对框架的引用也就是对window对象的引用。有了这个window对象，就可以很方便地对其中的页面进行操作，例如使用window.document对象向页面写入数据、使用window.location属性来改变框架内的页面等。

和parent属性类似，window对象还有一个top属性。它表示对顶层框架的引用，这可以用来判断一个框架自身是否为顶层框架，例如：

```js
// 判断本框架是否为顶层框架
if(self==top){
  //dosomething
}
```

### 选项卡

```html
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <meta name="keywords" content="关键词1,关键词2,关键词3" />
    <meta name="description" content="对网站的描述" />
    <title>标题</title>
    <style type="text/css">
      *{
        margin:0;
        padding:0;
      }
       #box{
        margin: 150px;
        width: 310px;
        height: 263px;
       }
       #box .hd{
        height: 30px;
        border-top: 2px solid #206F96;
        text-align: center;
        font: 14px/30px "宋体";
       }
       #box  .hd .s1{
        width: 102px;
        height: 29px;
        border-left:1px solid #CFCFCF;
        border-right: 1px solid #CFCFCF;
        float: left;
       }
       #box  .hd .s2{
        width: 102px;
        height: 29px;
        border-right: 1px solid #CFCFCF;
        border-bottom: 1px solid #CFCFCF;
        background:url(images/1.jpg) repeat-x;
        float: left;
       }
        #box  .hd .s3{
        width: 102px;
        height: 29px;
        border-right: 1px solid #CFCFCF;
        border-bottom: 1px solid #CFCFCF;
        background:url(images/1.jpg) repeat-x;
        float: left;
       }
       #box .bd ul{
        list-style: none;
       }
        #box .bd ul li{
          line-height: 30px;
        }
        #box .bd ul li a:link,#box .bd ul li a:visited{
          text-decoration: none;
          color: #666;
          font-size: 14px;
        }
        #tupian,#junshi{
          display: none;
        }
    </style>
    <script type="text/javascript">
      function xianshitupian(){
        //让图片列表显示出来
        document.getElementById("tupian").style.display = "block";
        //让新闻列表隐藏
        document.getElementById("xinwen").style.display = "none";
        //让军事列表隐藏
        document.getElementById("junshi").style.display = "none";

        //让图片span去掉背景
        document.getElementById("span_tupian").style.background = "none";
        //让新闻span加上灰色背景
        document.getElementById("span_xinwen").style.background = "url(images/1.jpg) repeat-x";
        //让军事span加上灰色背景
        document.getElementById("span_junshi").style.background = "url(images/1.jpg) repeat-x";

        //让图片span去掉下边框线
        document.getElementById("span_tupian").style.borderBottom = "none";
        //让新闻span加上下边框线
        document.getElementById("span_xinwen").style.borderBottom = "1px solid #CFCFCF";
        //让军事span加上下边框线
        document.getElementById("span_junshi").style.borderBottom = "1px solid #CFCFCF";
      }

      function xianshixinwen(){
        //让新闻列表显示出来
        document.getElementById("xinwen").style.display = "block";
        //让图片列表隐藏
        document.getElementById("tupian").style.display = "none";
        //让军事列表隐藏
        document.getElementById("junshi").style.display = "none";

        //让新闻span去掉背景
        document.getElementById("span_xinwen").style.background = "none";
        //让图片span加上灰色背景
        document.getElementById("span_tupian").style.background = "url(images/1.jpg) repeat-x";
        //让军事span加上灰色背景
        document.getElementById("span_junshi").style.background = "url(images/1.jpg) repeat-x";

        //让新闻span去掉下边框线
        document.getElementById("span_xinwen").style.borderBottom = "none";
        //让图片span加上下边框线
        document.getElementById("span_tupian").style.borderBottom = "1px solid #CFCFCF";
        //让军事span加上下边框线
        document.getElementById("span_junshi").style.borderBottom = "1px solid #CFCFCF";
      }

      function xianshijunshi(){
        //让军事列表显示出来
        document.getElementById("junshi").style.display = "block";
        //让图片列表隐藏
        document.getElementById("tupian").style.display = "none";
        //让新闻列表隐藏
        document.getElementById("xinwen").style.display = "none";

        //让军事span去掉背景
        document.getElementById("span_junshi").style.background = "none";
        //让图片span加上灰色背景
        document.getElementById("span_tupian").style.background = "url(images/1.jpg) repeat-x";
        //让新闻span加上灰色背景
        document.getElementById("span_xinwen").style.background = "url(images/1.jpg) repeat-x";

        //让军事span去掉下边框线
        document.getElementById("span_junshi").style.borderBottom = "none";
        //让图片span加上下边框线
        document.getElementById("span_tupian").style.borderBottom = "1px solid #CFCFCF";
        //让新闻span加上下边框线
        document.getElementById("span_xinwen").style.borderBottom = "1px solid #CFCFCF";
      }
    </script>
  </head>
  <body>
     <div id="box">
      <div class="hd">
        <span id="span_xinwen" class="s1" onmouseover="xianshixinwen()">新闻</span>
        <span id="span_tupian" class="s2" onmouseover="xianshitupian()">图片</span>
        <span id="span_junshi" class="s3" onmouseover="xianshijunshi()">军事</span>
      </div>
      <div class="bd">
        <div id="xinwen" class="info">
          <ul>  
            <li><a href="#">新闻新闻新闻新闻新闻新闻新闻新闻</a></li>
            <li><a href="#">新闻新闻新闻新闻新闻新闻新闻新闻</a></li>
            <li><a href="#">新闻新闻新闻新闻新闻新闻新闻新闻</a></li>
            <li><a href="#">新闻新闻新闻新闻新闻新闻新闻新闻</a></li>
            <li><a href="#">新闻新闻新闻新闻新闻新闻新闻新闻</a></li>
            <li><a href="#">新闻新闻新闻新闻新闻新闻新闻新闻</a></li>
            <li><a href="#">新闻新闻新闻新闻新闻新闻新闻新闻</a></li>
          </ul>
        </div>
        <div id="tupian" class="info">
          <ul>  
            <li><a href="#">图片图片图片图片图片图片图片图片</a></li>
            <li><a href="#">图片图片图片图片图片图片图片图片</a></li>
            <li><a href="#">图片图片图片图片图片图片图片图片</a></li>
            <li><a href="#">图片图片图片图片图片图片图片图片</a></li>
            <li><a href="#">图片图片图片图片图片图片图片图片</a></li>
            <li><a href="#">图片图片图片图片图片图片图片图片</a></li>
            <li><a href="#">图片图片图片图片图片图片图片图片</a></li>
            <li><a href="#">图片图片图片图片图片图片图片图片</a></li>
          </ul>
        </div>
        <div id="junshi" class="info">
          <ul>  
            <li><a href="#">军事军事军事军事军事军事军事军事</a></li>
            <li><a href="#">军事军事军事军事军事军事军事军事</a></li>
            <li><a href="#">军事军事军事军事军事军事军事军事</a></li>
            <li><a href="#">军事军事军事军事军事军事军事军事</a></li>
            <li><a href="#">军事军事军事军事军事军事军事军事</a></li>
            <li><a href="#">军事军事军事军事军事军事军事军事</a></li>
            <li><a href="#">军事军事军事军事军事军事军事军事</a></li>
            <li><a href="#">军事军事军事军事军事军事军事军事</a></li>
          </ul>
        </div>
      </div>
     </div>
  </body>
</html>
```

### 下拉框

```html
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>下拉框</title>
</head>

<body>
  <select name="objSelect">
    <option value="鸣人">鸣人</option>
    <option value="佐助">佐助</option>
    <option value="路飞">路飞</option>
    <option value="佐罗">佐罗</option>
    <option value="黑崎一护">黑崎一护</option>
    <option value="蓝染">蓝染</option>
    <option value="幽助">幽助</option>
  </select>
  <input type="button" value="孙悟空" onclick="jsAddItemToSelect(document.all.objSelect,'孙悟空','孙悟空')" />
  <input type="button" value="黑崎一护" onclick="jsRemoveItemFromSelect(document.all.objSelect,'黑崎一护')" />
  <script type="text/javascript">
    // 1.判断select选项中是否存在Value=objItemValue的Item

    function jsSelectIsExitItem(objSelect, objItemValue) {
      var isExit = false;
      for (var i = 0; i < objSelect.options.length; i++) {
        if (objSelect.options[i].value == objItemValue) {
          isExit = true;
          break;
        }
      }
      return isExit;
    }

    // 2.向select选项中 加入一个Item
    function jsAddItemToSelect(objSelect, objItemText, objItemValue) {
      //判断是否存在
      if (jsSelectIsExitItem(objSelect, objItemValue)) {
        alert("该Item的Value值已经存在");
      } else {
        var varItem = new Option(objItemText, objItemValue);
        objSelect.options.add(varItem);
        alert("成功加入");
      }
    }

    // 3.从select选项中 删除一个Item
    function jsRemoveItemFromSelect(objSelect, objItemValue) {
      //判断是否存在
      if (jsSelectIsExitItem(objSelect, objItemValue)) {
        for (var i = 0; i < objSelect.options.length; i++) {
          if (objSelect.options[i].value == objItemValue) {
            objSelect.options.remove(i);
            break;
          }
        }
        alert("成功删除");
      } else {
        alert("该select中 不存在该项");
      }
    }

    // 4.删除select中选中的项
    function jsRemoveSelectedItemFromSelect(objSelect) {
      var length = objSelect.options.length - 1;
      for (var i = length; i >= 0; i--) {
        if (objSelect[i].selected == true) {
          objSelect.options[i] = null;
        }
      }
    }

    // 5.修改select选项中 value="paraValue"的text为"paraText"
    function jsUpdateItemToSelect(objSelect, objItemText, objItemValue) {
      //判断是否存在
      if (jsSelectIsExitItem(objSelect, objItemValue)) {
        for (var i = 0; i < objSelect.options.length; i++) {
          if (objSelect.options[i].value == objItemValue) {
            objSelect.options[i].text = objItemText;
            break;
          }
        }
        alert("成功修改");
      } else {
        alert("该select中 不存在该项");
      }
    }

    // 6.设置select中text="paraText"的第一个Item为选中
    function jsSelectItemByValue(objSelect, objItemText) {
      //判断是否存在
      var isExit = false;
      for (var i = 0; i < objSelect.options.length; i++) {
        if (objSelect.options[i].text == objItemText) {
          objSelect.options[i].selected = true;
          isExit = true;
          break;
        }
      }
      //Show出结果
      if (isExit) {
        alert("成功选中");
      } else {
        alert("该select中 不存在该项");
      }
    }

    /*
    // 7.设置select中value="paraValue"的Item为选中
    document.all.objSelect.value = objItemValue;

    // 8.得到select的当前选中项的value
    var currSelectValue = document.all.objSelect.value;

    // 9.得到select的当前选中项的text
    var currSelectText = document.all.objSelect.options[document.all.objSelect.selectedIndex].text;

    // 10.得到select的当前选中项的Index
    var currSelectIndex = document.all.objSelect.selectedIndex;

    // 11.清空select的项
    document.all.objSelect.options.length = 0;
    */
  </script>
</body>

</html>
```

### 表格

```html
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
  <title>js操作表格</title>
  <script language="javascript">
    /*生成表格，采用appendChild*/
    function init() {
      _table = document.getElementById("table");
      _table.border = "1px";
      _table.width = "800px";

      for (var i = 1; i < 10; i++) {
        var row = document.createElement("tr");
        row.id = i;
        for (var j = 1; j < 6; j++) {
          var cell = document.createElement("td");
          cell.id = i + "/" + j;
          cell.appendChild(document.createTextNode("第" + cell.id + "列"));
          row.appendChild(cell);
        }
        document.getElementById("newbody").appendChild(row);
      }
    }

    function rebulid() {
      var beginRow = document.getElementById("beginRow").value;/*开始行*/
      var endRow = document.getElementById("endRow").value;/*结束行*/

      var beginCol = document.getElementById("beginCol").value;/*开始列*/
      var endCol = document.getElementById("endCol").value;/*结束列*/

      var tempCol = beginRow + "/" + beginCol;/*定位要改变属性的列*/
      alert(tempCol);
      var td = document.getElementById(tempCol);

      /*删除要合并的单元格*/
      for (var x = beginRow; x <= endRow; x++) {
        for (var i = beginCol; i <= endCol; i++) {
          if (x == beginRow) {

            document.getElementById("table").rows[x].deleteCell(i + 1);

          }
          else {

            document.getElementById("table").rows[x].deleteCell(i);

          }

        }
      }
      td.rowSpan = (endRow - beginRow) + 1;
    }
    /*添加行，使用appendChild方法*/
    function addRow() {
      var length = document.getElementById("table").rows.length;
      /*document.getElementById("newbody").insertRow(length);
      document.getElementById(length+1).setAttribute("id",length+2);*/
      var tr = document.createElement("tr");
      tr.id = length + 1;
      var td = document.createElement("td");
      for (i = 1; i < 4; i++) {
        td.id = tr.id + "/" + i;
        td.appendChild(document.createTextNode("第" + td.id + "列"));
        tr.appendChild(td);

      }
      document.getElementById("newbody").appendChild(tr);
    }

    function addRow_withInsert() {
      var row = document.getElementById("table").insertRow(document.getElementById("table").rows.length);
      var rowCount = document.getElementById("table").rows.length;

      var countCell = document.getElementById("table").rows.item(0).cells.length;
      for (var i = 0; i < countCell; i++) {
        var cell = row.insertCell(i);

        cell.innerHTML = "新" + (rowCount) + "/" + (i + 1) + "列";
        cell.id = (rowCount) + "/" + (i + 1);

      }
    }

    /*删除行，采用deleteRow(row Index)*/
    function removeRow() {
      /* var row=document.getElementById("2");
       var index=row.rowIndex;
       alert(index);*/
      document.getElementById("newbody").deleteRow(document.getElementById(document.getElementById("table").rows.length).rowIndex);
    }

    /*添加列，采用insertCell(列位置)方法*/
    function addCell() {
      /*document.getElementById("table").rows.item(0).cells.length
       用来获得表格的列数
      */
      for (var i = 0; i < document.getElementById("table").rows.length; i++) {
        var cell = document.getElementById("table").rows[i].insertCell(2);
        cell.innerHTML = "第" + (i + 1) + "/" + 3 + "列";

      }
    }
    /*删除列，采用deleteCell(列位置)的方法*/
    function removeCell() {
      for (var i = 0; i < document.getElementById("table").rows.length; i++) {
        document.getElementById("table").rows[i].deleteCell(0);
      }
    }
  </script>
</head>

<body onLoad="init();">

  <table id="table" align="center">
    <tbody id="newbody"></tbody>

  </table>
  <div>
    <table width="800px" border="1px" align="center">
      <tr>
        <td align="center"><input type="button" id="addRow" name="addRow" onClick="addRow();" value="添加行" /></td>
        <td align="center"><input type="button" id="delRow" name="delRow" onClick="removeRow();" value="删除行" /></td>
      </tr>
      　　<tr>
        <td align="center"><input type="button" id="delCell" 　name="delCell" onClick="removeCell();" value="删除列" /></td>
        <td align="center"><input type="button" 　id="addCell" name="addCell" onClick=" addCell();" value="添加列" /></td>
      </tr>
      　<tr>
        <td align="center" colspan="2"><input type="button" id="addRows" 　name="addRows" onClick="addRow_withInsert();"
            value="添加行" /></td>
      </tr>
    </table>
  </div>
  <div>
    <table width="800px" border="1px" align="center">
      <tr>
        <td>从第<input type="text" id="beginRow" name="beginRow" value="" />行到<input type="text" name="endRow" id="endRow"
            value="" />行</td>
        <td rowspan="2" id="test"><input type="button" name="hebing" id="hebing" value="合并" onClick="rebulid();" /></td>
      </tr>
      　　<tr>
        <td>从第<input type="text" name="beginCol" id="beginCol" value="" />列到<input type="text" name="endCol" id="endCol"
            value="" />列</td>
      </tr>
    </table>
  </div>
</body>

</html>
```

## 4.事件处理

事件|说明
-|-
keydown|当用户按下键盘上的任意键时触发，如果按住不放的话，会重复触发此事件
keypress|当用户按下键盘上的<b style="color:red">字符</b>键时触发，如果按住不让的话，会重复触发此事件
keyup|当用户释放键盘上的字符键时触发

> 那么对应的keyCode（键码）和charCode（字符编码）是什么样子的呢？
> 
> 1、在发生keydown和keyup事件时，event对象的keyCode属性会包含一个代码，与键盘上的一个特定的键对应。对数字字母键，keyCode属性的值与ASCII码中对应小写字母或者数字的编码相同
> 
> 2、发生keypress事件意味着按下的键会影响到屏幕中文本的显示。在所有的浏览器中，按下能够插入或者删除字符的键都会触发keypress事件。IE9，FireFox、Chrome和Safari的event对象都支持一个charCode属性，这个属性只有在发生keypress事件时，才包含值，而且这个值是按下的那个键所代表的字符的ASCII编码。此时的keyCode通常等于0或者也可能等于所按键的键码。
> 
> 按下键盘会触发键盘事件，顺序依次为：keydown->keypress->keyup.
>
> 3、keydown、keypress事件触发时文字还没敲进文本框，就像上面的keypress事件，只是按下字符键显示的结果，即得到的是触发键盘事件前的文本。而keyup是事件触发整个键盘事件的操作已经完成，获得的是触发键盘事件后的文本。
>
> keypress与keydown与keyup的主要区别：  
>（1）对中文输入法不友好，无法响应中文输入；  
>（2）无法响应系统功能键（比如delete，backspace）；  
>（3）由于前面两个限制，keypress与keydown和keyup不是很一致；
>
> 在keyup中无法是无法阻止浏览器的默认事件的，因为在keypress时，浏览器默认行为已经完成，即将输入字符输入文本框（尽管这时还没有显示），这个时候不管是preventDefault还是return false，都不能阻止在文本框中输入文字的行为，如要阻止在文本框中输入文字，必须在keydown或者keypress时，即时阻止。
>
> 4、textInput事件
> 
> 文本框的键盘响应事件把textInpput也加进来，触发的顺序为：keydown -> keypress ->textInput -> keyup
> 
> textInput事件是DOM3后支持的，主要用来替换keypress，与keypress的主要差别在于添加了对中文输入法的支持，还有一点就是textInput只在可编辑文本区才能触发（如input、textarea），而keypress是任何能获得焦点的控件的能触发（如button），但是textInput事件的支持还不是很好，目前只有safari、chrome支持。
